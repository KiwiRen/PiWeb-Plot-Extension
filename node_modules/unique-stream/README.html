<h1>unique-stream</h1>
<p>node.js through stream that emits a unique stream of objects based on criteria</p>
<p><a href="http://travis-ci.org/eugeneware/unique-stream"><img src="https://secure.travis-ci.org/eugeneware/unique-stream.png" alt="build status"></a></p>
<h2>Installation</h2>
<p>Install via npm:</p>
<pre><code>$ npm install unique-stream
</code></pre>
<h2>Examples</h2>
<h3>Dedupe a ReadStream based on JSON.stringify:</h3>
<pre><code class="language-js"><span class="hljs-keyword">var</span> unique = <span class="hljs-built_in">require</span>(<span class="hljs-string">'unique-stream'</span>)
  , Stream = <span class="hljs-built_in">require</span>(<span class="hljs-string">'stream'</span>);

<span class="hljs-comment">// return a stream of 3 identical objects</span>
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">makeStreamOfObjects</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">var</span> s = <span class="hljs-keyword">new</span> Stream;
  s.readable = <span class="hljs-literal">true</span>;
  <span class="hljs-keyword">var</span> count = <span class="hljs-number">3</span>;
  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-number">3</span>; i++) {
    setImmediate(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
      s.emit(<span class="hljs-string">'data'</span>, { <span class="hljs-attr">name</span>: <span class="hljs-string">'Bob'</span>, <span class="hljs-attr">number</span>: <span class="hljs-number">123</span> });
      --count &amp;&amp; end();
    });
  }

  <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span>(<span class="hljs-params"></span>) </span>{
    s.emit(<span class="hljs-string">'end'</span>);
  }

  <span class="hljs-keyword">return</span> s;
}

<span class="hljs-comment">// Will only print out one object as the rest are dupes. (Uses JSON.stringify)</span>
makeStreamOfObjects()
  .pipe(unique())
  .on(<span class="hljs-string">'data'</span>, <span class="hljs-built_in">console</span>.log);

</code></pre>
<h3>Dedupe a ReadStream based on an object property:</h3>
<pre><code class="language-js"><span class="hljs-comment">// Use name as the key field to dedupe on. Will only print one object</span>
makeStreamOfObjects()
  .pipe(unique(<span class="hljs-string">'name'</span>))
  .on(<span class="hljs-string">'data'</span>, <span class="hljs-built_in">console</span>.log);
</code></pre>
<h3>Dedupe a ReadStream based on a custom function:</h3>
<pre><code class="language-js"><span class="hljs-comment">// Use a custom function to dedupe on. Use the 'number' field. Will only print one object.</span>
makeStreamOfObjects()
  .pipe(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">data</span>) </span>{
    <span class="hljs-keyword">return</span> data.number;
  })
  .on(<span class="hljs-string">'data'</span>, <span class="hljs-built_in">console</span>.log);
</code></pre>
<h2>Dedupe multiple streams</h2>
<p>The reason I wrote this was to dedupe multiple object streams:</p>
<pre><code class="language-js"><span class="hljs-keyword">var</span> aggregator = unique();

<span class="hljs-comment">// Stream 1</span>
makeStreamOfObjects()
  .pipe(aggregator);

<span class="hljs-comment">// Stream 2</span>
makeStreamOfObjects()
  .pipe(aggregator);

<span class="hljs-comment">// Stream 3</span>
makeStreamOfObjects()
  .pipe(aggregator);

aggregator.on(<span class="hljs-string">'data'</span>, <span class="hljs-built_in">console</span>.log);
</code></pre>
